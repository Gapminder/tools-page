// admin.styl — dark tech vibes, compact, elegant

// ---------- Theme tokens ----------
:root
  --bg-0        #0f1115
  --bg-1        #141823
  --bg-2        #1b2030
  --txt-0       #e6e9ee
  --txt-1       #b4b9c4
  --brand       #6ea8fe
  --brand-dim   rgba(110,168,254,0.2)
  --good        #3fcf8e
  --good-dim    rgba(63,207,142,0.2)
  --warn        #f0b429
  --bad         #ef6a6a
  --bad-dim     rgba(239,106,106,0.2)
  --line        #2a3142
  --shadow      rgba(0,0,0,.45)

  --sidebar-w   130px
  --sidebar-w-min 51px
  --header-h    56px
  --radius      12px

*,
*::before,
*::after
  box-sizing border-box

html, body 
  height 100%
  margin 0
  background-color var(--bg-0) !important
  color var(--txt-0)
  font 14px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial

a
  color var(--brand)
  text-decoration none
  &:hover
    text-decoration underline

.closecross
  cursor: pointer;
  color: var(--txt-1)
  &:hover
    color: var(--txt-0)

// ---------- Layout ----------
.admin-page
  display grid
  grid-template-rows var(--header-h) 1fr
  grid-template-columns var(--sidebar-w) 1fr
  min-height 100dvh
  background var(--bg-0)
  transition grid-template-columns .2s ease
  height: 100vh;

  &.is-collapsed
    grid-template-columns var(--sidebar-w-min) 1fr

.admin-footer
  width: 100%;
  min-height: 100px;

.admin-header
  grid-column 1 / -1
  background linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0)) , var(--bg-1)
  border-bottom 1px solid var(--line)
  display flex
  align-items center
  gap 10px
  padding 0 12px
  position sticky
  top 0

  .brand
    font-weight 700
    letter-spacing .3px
    color var(--txt-0)

  .header-spacer
    flex 1

.admin-sidebar
  grid-row 2
  background var(--bg-1)
  border-right 1px solid var(--line)
  display flex
  flex-direction column
  padding 8px 6px
  gap 6px
  overflow hidden
  position relative

  .sidebar-toggle
    color: var(--bg-0)
    font-size: 2em;
    padding: 0px;
    top: calc(50% - 32px);
    position: absolute;
    right: -1px;
    width 10px
    height 64px
    border 1px solid var(--line)
    border-top-left-radius: 8px
    border-bottom-left-radius: 8px
    background var(--bg-2)
    cursor pointer
    transition width .15s ease, background .15s ease
    &:hover
      width 16px 
      background rgba(255,255,255,.03)

  // keep login at the bottom
  .user-login-wrapper
    margin-top auto
    padding 8px 6px
    border-top 1px solid var(--line)
    display flex
    align-items center
    gap 8px
    .avatar
      width 24px
      height 24px
      border-radius 50%
      background var(--bg-2)
      border 1px solid var(--line)

  // nav
  .nav
    display flex
    flex-direction column
    gap 4px

  .nav-item
    display grid
    grid-template-columns 30px 1fr
    align-items center
    gap 8px
    min-height 45px
    padding 4px 4px
    border-radius 10px
    color var(--txt-1)
    cursor pointer
    border 1px solid transparent
    transition background .15s ease, border-color .15s ease, color .15s ease
    &:hover
      background rgba(255,255,255,.04)
      border-color var(--line)
      color var(--txt-0)
    &.active
      background linear-gradient(180deg, rgba(110,168,254,.15), rgba(110,168,254,.02))
      border-color rgba(110,168,254,.35)
      color var(--txt-0)

    .icon
      inline-size 28px
      block-size 28px
      display grid
      place-items center
      border-radius 8px
      background var(--bg-2)
      border 1px solid var(--line)
      font-size 16px

    .label
      white-space nowrap
      overflow hidden
      text-overflow ellipsis

// collapse label when page collapsed
.admin-page.is-collapsed .admin-sidebar
  .nav-item
    grid-template-columns 30px 0
  .nav-item .label
    display none

.admin-stage
  grid-row 2
  padding 16px clamp(12px, 2vw, 24px)
  overflow-x hidden
  overflow-y auto
  background radial-gradient(1200px 600px at 20% -10%, rgba(110,168,254,.08), transparent 60%), var(--bg-0)
  display: flex;
  flex-direction: column;
  gap: 30px;

  h1, h2
    margin 10px 0 8px
    line-height 1.2
  h1
    font-size clamp(18px, 2.4vw, 28px)
  h2
    font-size clamp(15px, 2vw, 22px)
    color var(--txt-1)

  .admin-grid
    display grid
    gap 12px
    grid-template-columns repeat(auto-fill, minmax(400px, 1fr))

 

  .admin-card
    position relative
    cursor pointer
    transition border-color .15s ease, box-shadow .15s ease, background .15s ease, transform .05s ease
    outline none
    background linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)), var(--bg-1)
    border 1px solid var(--line)
    border-radius var(--radius)
    box-shadow 0 4px 16px var(--shadow)
    padding 12px
    display flex
    flex-direction column
    gap 8px
    min-height: 139px;

    div
      z-index 1 //in front of img
    
    img
      z-index 0
      width: 14%;
      position: absolute;
      right: 0px;
      top: 0px;
      opacity: 0.8;
      margin-top: 10px;
      margin-right: 5px;
      filter: grayscale(1) contrast(1) brightness(1.4) hue-rotate(320deg);
    &.is-selected img
      filter: grayscale(0.5) contrast(1) brightness(1) hue-rotate(320deg);


    .card-title
      font-weight 600
      color var(--txt-0)
    .card-sub, .serverstatus
      color var(--txt-1)
      font-size 12px

    .badge
      font-size 11px
      padding 2px 8px
      border-radius 4px
      margin-rigth: 5px
      border 1px solid var(--line)
      background var(--bg-2)
      &.ok
        border-color rgba(63,207,142,.5)
        color var(--good)
      &.waiting
        border-color rgba(240,180,41,.5)
        color var(--warn)
      &.error
        border-color rgba(239,106,106,.5)
        color var(--bad)

    // interactivity
    &:hover
      border-color rgba(110,168,254,.45)
      background linear-gradient(180deg, rgba(110,168,254,.06), rgba(255,255,255,0)), var(--bg-1)

    &:active
      transform translateY(1px)

    &:focus-visible
      box-shadow 0 0 0 2px rgba(110,168,254,.6), 0 6px 20px var(--shadow)

    &.is-selected
      border-color rgba(110,168,254,.9)
      box-shadow 0 10px 28px rgba(110,168,254,.15), 0 2px 0 rgba(110,168,254,.35) inset
      background linear-gradient(180deg, rgba(110,168,254,.12), rgba(255,255,255,0)), var(--bg-1)

    // optional subtle top highlight bar when selected
    &.is-selected::before
      content: ""
      position absolute
      inset 0 0 auto 0
      height 4px
      background linear-gradient(90deg, rgba(110, 168, 254, 0.0), rgba(110, 168, 254, 0.7), rgba(110, 168, 254, 0)) 
      border-top-left-radius var(--radius)
      border-top-right-radius var(--radius)


section 
  max-width: 1100px;
  .admin-section-header, .admin-section-footer
    display: flex;
    align-items: center;
    justify-content: space-between;
    .button
      min-height: 30px;

// tables in stage
.admin-table
  margin-top: 10px
  margin-bottom: 10px
  width 100%
  border-collapse collapse
  font-size 13px
  color var(--txt-1)
  tr, td 
    position: relative // to position the .crossed element correctly
  td, th
    padding 8px 10px
    border-bottom 1px solid var(--line)
    background-color var(--bg-2)
    text-align left
  tr:hover td
    background rgba(255,255,255,.02)
  td:first-child .button { width: 100%; max-width 60px; };
  td:first-child .actionsbox {flex-direction: column}  

  td.branch .branchname
    &::before
      content: "⼘"
      width: 0.5em; height: 0.4em;
      display: inline-block;
      margin-right: 0.6em;
    &.default::before
      border-top: 1px solid var(--txt-1);
      border-left: 1px solid var(--txt-1);    

  tr.nonremovable
    .button.delete, .button.addnew
      display: none

  //disable buttons but make exception to undo the addition action
  .for-deletion .button, .for-addition .button:not(.delete)
    display: none
    
  .overlay 
    display: none;
    cursor: not-allowed;
    position: absolute; top: 0; left: 0; bottom: 0; right: 0;

  .for-deletion>.overlay
    display: block;
    background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' preserveAspectRatio='none'><line x1='0' y1='100' x2='100' y2='0' stroke='red' stroke-width='2'/></svg>") center/100% 100% no-repeat;

  .for-addition>.overlay
    opacity: 0.6
    display: block;
    left: 30px; //reveal a bit of the button underneath to undo the addition
    background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'><text x='0' y='16' transform='rotate(-45 10 10)' font-family='system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif' font-size='9' fill='green' text-rendering='geometricPrecision'>NEW</text></svg>") repeat;
    background-size: 20px 20px;   /* matches SVG width/height */
    background-repeat: repeat;
    background-origin: padding-box;
    background-clip: padding-box;

.access-control-dialog 
  position: absolute
  top: 0
  left: 0
  right: 0
  bottom: 0
  visibility: hidden
  display: flex
  align-items: center;
  justify-content: center;
  .header 
    font-size: 16pt;
    color: var(--txt-0)

  .closecross
    position: absolute
    right: 10px
    top: 10px

  .blur
    position: absolute;
    width: 100%
    height: 100%

  .box
    position: absolute;
    background: var(--bg-1)
    opacity: 1
    max-width: 800px;
    max-height: 800px;
    width: 80%;
    height: 80%
    border: 1px solid var(--brand-dim);
    padding: 10px


// scrollbars (blink/webkit)
.admin-sidebar::-webkit-scrollbar,
.admin-stage::-webkit-scrollbar
  width 10px
.admin-sidebar::-webkit-scrollbar-thumb,
.admin-stage::-webkit-scrollbar-thumb
  background #202737
  border 2px solid var(--bg-1)
  border-radius 10px

// motion accessibility
@media (prefers-reduced-motion: reduce)
  .admin-page,
  .sidebar-toggle,
  .nav-item
    transition none


.form 
  background: var(--bg-2);
  border:1px solid var(--line);
  padding:12px; 
  display: flex;
  flex-direction: column;
  gap:10px;
  input 
    vertical-align: middle

.form-grow {flex-grow: 1}
.form-row { display: flex; flex-wrap: wrap; align-items: center; gap:15px;}
.form-row.collapsed div.collapsable {display:none}
.form-col { display: flex; align-items: center; gap: 5px;}
.label { color: var(--txt-1); font-size:12px; }
.label.advanced:hover { text-decoration: underline; cursor:pointer;}
.label.advanced::after { content: "▶"; }
.label.required::after {content: "*"; color: var(--bad); position: relative; top: -6px; left: -2px; }
.input { width: 100%; padding:10px 12px; border-radius:10px; border:1px solid var(--brand);
  background: var(--bg-2); color: var(--txt-0); outline: none; }
.input:focus { box-shadow: 0 0 0 2px rgba(110,168,254,.5); }
.radio-group { display:flex; gap:8px; flex-wrap:wrap; }
.radio { display:flex; gap:6px; align-items:center; padding:6px 10px; cursor:pointer; user-select:none; }
.radio input { accent-color: var(--brand); }
.radio-label { text-transform: capitalize; color: var(--txt-0); }
.form-msg { min-height: 18px; font-size: 12px; color: var(--txt-1); }
.form-msg.is-ok { color: var(--good); }
.form-msg.is-error { color: var(--bad); }
.form .button {padding:10px 12px; border-radius:10px;}

.message.is-ok { color: var(--good); border-color: var(--good); }
.message.is-error { color: var(--bad); border-color: var(--bad); }
.message.is-working { color: var(--warn); border-color: var(--warn); }
.message 
  pointer-events: none
  display: none;
  z-index: 1;
  position: fixed;
  bottom: 30px;
  width: 50%;
  padding: 10px;
  max-width: 900px;
  background: var(--bg-1)
  border: 1px solid var(--line)
  border-radius: 10px
  align-self: end
  opacity: 0.7

.button.delete
  color: var(--bad)
  border: 1px solid var(--bad)
  &:hover
    background linear-gradient(180deg, rgba(239,106,106,.05), rgba(255,255,255,0)), var(--bad-dim)

.button.addnew
  color: var(--good)
  border: 1px solid var(--good)
  &:hover
    background linear-gradient(180deg, rgba(63,207,142,.05), rgba(255,255,255,0)), var(--good-dim)

.button
  opacity: 0.8
  cursor: pointer
  user-select: none
  border-radius: 4px
  padding: 2px 6px
  width: fit-content;
  background linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,0)), var(--bg-2)
  color: var(--brand)
  border: 1px solid var(--brand)
  &.micro
    font-size: 1.2em
    padding: 0px 4px
  &:hover
    opacity: 1
    background linear-gradient(180deg, rgba(110,168,254,.05), rgba(255,255,255,0)), var(--brand-dim)
  
.blurry
  filter: blur(3px) grayscale(80%);


.actionsbox 
  display: flex;
  gap: 10px;
  &.micro
    gap: 5px;




// hold-delete.styl

.hold-btn
  position: relative
  overflow: hidden
  display: inline-flex
  align-items: center
  justify-content: center  
  background: var(--bg-2)
  color: var(--bad)
  font-weight: 600
  cursor: pointer
  user-select: none
  transition: transform .1s ease, background .2s ease

  &:hover
    background: rgba(239,106,106,.1)

  &:active
    transform: scale(.97)

  &::before
    content: ""
    position: absolute
    inset: 0
    background: rgba(239,106,106,.3)
    transform: scaleX(0)
    transform-origin: left
    transition: transform 0s
    pointer-events: none
    z-index: 0

  &.is-holding::before
    transition: transform 1s linear
    transform: scaleX(1)

  &.is-done
    background: var(--bad)
    color: #fff
    border-color: var(--bad)
